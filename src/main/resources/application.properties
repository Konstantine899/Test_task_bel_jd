spring.application.name=records-app

# Порт приложения (будет переопределен через переменную PORT)
server.port=${PORT:8080}

# База данных PostgreSQL (локальные настройки закомментированы для production)
# spring.datasource.url=jdbc:postgresql://localhost:5432/records_db
# spring.datasource.username=app_user
# spring.datasource.password=secure_password_123

# Fallback переменные окружения для production
# spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/records_db}
# spring.datasource.username=${DB_USERNAME:app_user}
# spring.datasource.password=${DB_PASSWORD:secure_password_123}

# Класс драйвера базы данных
# org.postgresql.Driver - Java-класс для работы с PostgreSQL
spring.datasource.driver-class-name=org.postgresql.Driver

# Время ожидания подключения (30 секунд)
spring.datasource.hikari.connection-timeout=30000

# Максимальное количество подключений в пуле (настраивается через переменные окружения)
spring.datasource.hikari.maximum-pool-size=${SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE:10}

# ==============================================
# НАСТРОЙКИ HIBERNATE (ORM - ВЗАИМОДЕЙСТВИЕ С БАЗОЙ)
# ==============================================

# Диалект Hibernate для PostgreSQL
# org.hibernate.dialect.PostgreSQLDialect - "переводчик" команд Hibernate в SQL PostgreSQL
spring.jpa.properties.hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect
# Стратегия создания схемы базы данных
# validate - Hibernate только проверяет схему (миграции управляют созданием)
# Варианты: validate (только проверка) | update (обновление) | create (создание заново) | create-drop (создание и удаление при завершении)
# spring.jpa.hibernate.ddl-auto=update
# Показывать SQL запросы в консоли (настраивается через переменные окружения)
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:true}
# Использовать комментарии в SQL (настраивается через переменные окружения)
spring.jpa.properties.hibernate.use_sql_comments=${SPRING_JPA_PROPERTIES_HIBERNATE_USE_SQL_COMMENTS:true}
# Разрешаем Hibernate использовать тип PostgreSQL 'text' для полей @Lob
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true


# ==============================================
# НАСТРОЙКИ ШАБЛОНИЗАТОРА THYMELEAF
# ==============================================

spring.thymeleaf.cache=${SPRING_THYMELEAF_CACHE:false}
# Префикс для поиска HTML шаблонов
spring.thymeleaf.prefix=classpath:/templates/
# Суффикс для HTML файлов
spring.thymeleaf.suffix=.html

# ==============================================
# НАСТРОЙКИ КОДИРОВКИ
# ==============================================
spring.thymeleaf.encoding=UTF-8
# Кодировка для русского языка
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.force=true
# Принудительное применение кодировки для запросов
server.servlet.encoding.force-request=true
# Принудительное применение кодировки для ответов
server.servlet.encoding.force-response=true

# ==============================================
# НАСТРОЙКИ ЗАГРУЗКИ ФАЙЛОВ (MULTIPART)
# ==============================================
# Максимальный размер одного файла (10 мегабайт)
spring.servlet.multipart.max-file-size=10MB
# Максимальный размер всего запроса (10 мегабайт)
spring.servlet.multipart.max-request-size=10MB
# Включение обработки multipart-запросов
spring.servlet.multipart.enabled=true
# Пороговое значение для записи на диск (2KB - в памяти, больше - на диск)
spring.servlet.multipart.file-size-threshold=2KB
# Директория для временного хранения файлов (настраивается через переменные окружения)
spring.servlet.multipart.location=${SPRING_SERVLET_MULTIPART_LOCATION:/tmp/records_app_uploads}

# START: Настройки миграций
# ==============================================
# МИГРАЦИИ ВЫПОЛНЯЮТСЯ ЧЕРЕЗ MigrationService
# ==============================================
spring.sql.init.mode=never

# Hibernate создает схему автоматически (create-drop для dev, validate для production)
# create-drop: создает таблицы при старте, удаляет при завершении
# validate: только проверяет схему (для production)
# spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:create-drop}

# Логирование (убрано отладочное для production)
logging.level.com.recordsapp=INFO
# END: Настройки миграций

# ==============================================
# НАСТРОЙКИ ACTUATOR (для health check)
# ==============================================
# Включаем endpoints для health check (настраивается через production профиль)
# management.endpoints.web.exposure.include=health,info
# Базовый путь для Actuator
management.endpoints.web.base-path=/actuator
# Показывать детали health check
management.endpoint.health.show-details=when-authorized


